%% Definition of model
M.name = 'NGFErk_1D_skew_norm'; 
M.n_subpop = 2; 
M.model = @(T,theta,u)simulate_SigmaPoints_sPsET_loglog_corr(T,theta,u(1)); 
M.theta = @(xi,u)[(2592480341699211*xi(1))/1125899906842624;(2592480341699211*xi(2))/1125899906842624;(2592480341699211*xi(3))/1125899906842624;(2592480341699211*xi(4))/1125899906842624;(2592480341699211*u(2)*xi(5))/1125899906842624 - (2592480341699211*xi(6)*(u(2) - 1))/1125899906842624;(2592480341699211*xi(7))/1125899906842624;log(log(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1)) + 1));(2592480341699211*xi(11))/1125899906842624;log(log(10^(2*xi(10)) + 1))];
M.dthetadxi= @(xi,u)[2592480341699211/1125899906842624,0,0,0,0,0,0,0,0,0,0,0,0,0;...
	0,2592480341699211/1125899906842624,0,0,0,0,0,0,0,0,0,0,0,0;...
	0,0,2592480341699211/1125899906842624,0,0,0,0,0,0,0,0,0,0,0;...
	0,0,0,2592480341699211/1125899906842624,0,0,0,0,0,0,0,0,0,0;...
	0,0,0,0,(2592480341699211*u(2))/1125899906842624,2592480341699211/1125899906842624 - (2592480341699211*u(2))/1125899906842624,0,0,0,0,0,0,0,0;...
	0,0,0,0,0,0,2592480341699211/1125899906842624,0,0,0,0,0,0,0;...
	0,0,0,0,0,0,0,(2*10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1))*u(2)*log(10))/(log(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1)) + 1)*(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1)) + 1)),-(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1))*log(10)*(2*u(2) - 2))/(log(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1)) + 1)*(10^(2*u(2)*xi(8) - 2*xi(9)*(u(2) - 1)) + 1)),0,0,0,0,0;...
	0,0,0,0,0,0,0,0,0,0,2592480341699211/1125899906842624,0,0,0;...
	0,0,0,0,0,0,0,0,0,(2*10^(2*xi(10))*log(10))/(log(10^(2*xi(10)) + 1)*(10^(2*xi(10)) + 1)),0,0,0,0];

% Subpopulation 1 
% Experiment 1 
s=1; e=1;
M.mean_ind{s,e} = [1];
M.var_ind{s,e} = [4];
M.w_ind{s,e} = [];
M.delta{s,e} = @(t,x,xi,u)[xi(14)];
M.ddeltadxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,1]);

M.mu{s,e} = @(t,x,delta,xi,u) [x(:,1) - (7186705221432913*delta)/9007199254740992];
M.dmudxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) bsxfun(@plus, [permute(dxdxi(1,:,:),[3,2,1])],...
	bsxfun(@plus,[-bsxfun(@rdivide,(bsxfun(@times,7186705221432913,ddeltadxi)),9007199254740992)],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,0]));

M.Sigma{s,e} = @(t,x,delta,xi,u) func_Sigma_skew_norm(t,x,delta,xi,1,[10^(2*xi(11))],'additive');
M.dSigmadxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) func_dSigmadxi_skew_norm(t,x,dxdxi,delta,ddeltadxi,xi,1,[10^(2*xi(11))],[0,0,0,0,0,0,0,0,0,0,2*10^(2*xi(11))*log(10),0,0,0],'additive');

M.w{s,e} = @(t,x,xi,u)[xi(13);xi(13);xi(13);xi(13);xi(13);xi(13);xi(13)];
M.dwdxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0;0;0;0;0;0;0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,1,0]);
M.distribution{s,e} = 'skew_norm';

M.u{s,e} = [0];
r=1;
M.scaling{r,e} = @(xi,u)[1];
M.offset{r,e} = @(xi,u)[10^xi(8)];
M.dscalingdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,0,0,0,0,0,0];
M.doffsetdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,10^xi(8)*log(10),0,0,0,0,0,0];
% Subpopulation 1 
% Experiment 2 
s=1; e=2;
M.mean_ind{s,e} = [1];
M.var_ind{s,e} = [4];
M.w_ind{s,e} = [];
M.delta{s,e} = @(t,x,xi,u)[xi(14)];
M.ddeltadxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,1]);

M.mu{s,e} = @(t,x,delta,xi,u) [x(:,1) - (7186705221432913*delta)/9007199254740992];
M.dmudxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) bsxfun(@plus, [permute(dxdxi(1,:,:),[3,2,1])],...
	bsxfun(@plus,[-bsxfun(@rdivide,(bsxfun(@times,7186705221432913,ddeltadxi)),9007199254740992)],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,0]));

M.Sigma{s,e} = @(t,x,delta,xi,u) func_Sigma_skew_norm(t,x,delta,xi,1,[10^(2*xi(12))],'additive');
M.dSigmadxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) func_dSigmadxi_skew_norm(t,x,dxdxi,delta,ddeltadxi,xi,1,[10^(2*xi(12))],[0,0,0,0,0,0,0,0,0,0,0,2*10^(2*xi(12))*log(10),0,0],'additive');

M.w{s,e} = @(t,x,xi,u)[xi(13)];
M.dwdxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,1,0]);
M.distribution{s,e} = 'skew_norm';

M.u{s,e} = [0];
r=1;
M.scaling{r,e} = @(xi,u)[10^xi(9)];
M.offset{r,e} = @(xi,u)[10^xi(10)];
M.dscalingdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,10^xi(9)*log(10),0,0,0,0,0];
M.doffsetdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,0,10^xi(10)*log(10),0,0,0,0];
% Subpopulation 2 
% Experiment 1 
s=2; e=1;
M.mean_ind{s,e} = [1];
M.var_ind{s,e} = [4];
M.w_ind{s,e} = [];
M.delta{s,e} = @(t,x,xi,u)[xi(14)];
M.ddeltadxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,1]);

M.mu{s,e} = @(t,x,delta,xi,u) [x(:,1) - (7186705221432913*delta)/9007199254740992];
M.dmudxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) bsxfun(@plus, [permute(dxdxi(1,:,:),[3,2,1])],...
	bsxfun(@plus,[-bsxfun(@rdivide,(bsxfun(@times,7186705221432913,ddeltadxi)),9007199254740992)],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,0]));

M.Sigma{s,e} = @(t,x,delta,xi,u) func_Sigma_skew_norm(t,x,delta,xi,1,[10^(2*xi(11))],'additive');
M.dSigmadxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) func_dSigmadxi_skew_norm(t,x,dxdxi,delta,ddeltadxi,xi,1,[10^(2*xi(11))],[0,0,0,0,0,0,0,0,0,0,2*10^(2*xi(11))*log(10),0,0,0],'additive');

M.w{s,e} = @(t,x,xi,u)[1 - xi(13);1 - xi(13);1 - xi(13);1 - xi(13);1 - xi(13);1 - xi(13);1 - xi(13)];
M.dwdxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0;0;0;0;0;0;0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0;...
	0,0,0,0,0,0,0,0,0,0,0,0,-1,0]);
M.distribution{s,e} = 'skew_norm';

M.u{s,e} = [1];
r=1;
M.scaling{r,e} = @(xi,u)[1];
M.offset{r,e} = @(xi,u)[10^xi(8)];
M.dscalingdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,0,0,0,0,0,0];
M.doffsetdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,10^xi(8)*log(10),0,0,0,0,0,0];
% Subpopulation 2 
% Experiment 2 
s=2; e=2;
M.mean_ind{s,e} = [1];
M.var_ind{s,e} = [4];
M.w_ind{s,e} = [];
M.delta{s,e} = @(t,x,xi,u)[xi(14)];
M.ddeltadxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,1]);

M.mu{s,e} = @(t,x,delta,xi,u) [x(:,1) - (7186705221432913*delta)/9007199254740992];
M.dmudxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) bsxfun(@plus, [permute(dxdxi(1,:,:),[3,2,1])],...
	bsxfun(@plus,[-bsxfun(@rdivide,(bsxfun(@times,7186705221432913,ddeltadxi)),9007199254740992)],...
	[0,0,0,0,0,0,0,0,0,0,0,0,0,0]));

M.Sigma{s,e} = @(t,x,delta,xi,u) func_Sigma_skew_norm(t,x,delta,xi,1,[10^(2*xi(12))],'additive');
M.dSigmadxi{s,e} = @(t,x,dxdxi,delta,ddeltadxi,xi,u) func_dSigmadxi_skew_norm(t,x,dxdxi,delta,ddeltadxi,xi,1,[10^(2*xi(12))],[0,0,0,0,0,0,0,0,0,0,0,2*10^(2*xi(12))*log(10),0,0],'additive');

M.w{s,e} = @(t,x,xi,u)[1 - xi(13)];
M.dwdxi{s,e} = @(t,x,dxdxi,xi,u)bsxfun(@plus, [0],...
	[0,0,0,0,0,0,0,0,0,0,0,0,-1,0]);
M.distribution{s,e} = 'skew_norm';

M.u{s,e} = [1];
r=1;
M.scaling{r,e} = @(xi,u)[10^xi(9)];
M.offset{r,e} = @(xi,u)[10^xi(10)];
M.dscalingdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,10^xi(9)*log(10),0,0,0,0,0];
M.doffsetdxi{r,e} = @(xi,u)[0,0,0,0,0,0,0,0,0,10^xi(10)*log(10),0,0,0,0];


parameters.name = {'log_{10}(k_1)',...
'log_{10}(k_2)',...
'log_{10}(k_4)',...
'log_{10}(k_5)',...
'log_{10}(\beta_{k_3[TrkA]_{0,1}})',...
'log_{10}(\beta_{k_3[TrkA]_{0,2}})',...
'log_{10}(\beta_{c_P^{1}[Erk]_{0}})',...
'log_{10}(o_P^{1})',...
'log_{10}(c_P^{2})',...
'log_{10}(o_P^{2})',...
'log_{10}(\sigma_{P,noise}^{1})',...
'log_{10}(\sigma_{P,noise}^{2})',...
'w_1',...
'\\delta_P'};
parameters.number = length(parameters.name);
parameters.max = [6;6;6;6;6;6;6;6;6;6;6;6;1;2];
parameters.min = [-6;-6;-6;-6;-6;-6;-6;-6;-6;-6;-6;-6;0;-2];
